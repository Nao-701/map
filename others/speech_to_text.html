<html>
<head>
<meta charset="UTF-8" />
<title>Web Speech API</title>
<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
<script>
window.SpeechRecognition = window.SpeechRecognition || webkitSpeechRecognition;
var recognition = new webkitSpeechRecognition();
recognition.lang = 'en';
recognition.interimResults = true;
recognition.continuous = true;

// 録音終了時トリガー
recognition.addEventListener('result', function(event){
    var text = event.results.item(0).item(0).transcript;
    document.getElementById('result_text').innerHTML = text
    //console.log(text);
    translate(text)
}, false);

// 録音開始

function record()
{
    recognition.start();
}

function translate(sourceText){
var sourceLang = 'en';
var targetLang = 'ja';
var url = "https://translate.googleapis.com/translate_a/single?client=gtx&sl="+ sourceLang + "&tl=" + targetLang + "&dt=t&q=" + encodeURI(sourceText);
//console.log(url);

$.getJSON(url, function(data) {
    document.getElementById('result_translate_text').innerHTML = data[0][0][0]
    });
}
</script>
</head>

<body onload="record();">

<p id="result_text"></p>
<p id="result_translate_text"></p>
<br />
</body>
</html>
